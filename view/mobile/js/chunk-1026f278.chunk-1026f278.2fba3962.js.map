{"version":3,"sources":["webpack:///../common/components/History/Form.vue?b7a1","webpack:///../common/components/History/index.vue?e18a","webpack:///../common/components/History/Form.vue?1903","webpack:///../common/components/History/Form.vue","webpack:///../common/components/History/Form.vue?a859","webpack:///../common/components/History/Form.vue?73aa","webpack:///../common/components/History/Item.vue?7c10","webpack:///../common/components/History/Item.vue","webpack:///../common/components/History/Item.vue?0844","webpack:///../common/components/History/Item.vue?0c2e","webpack:///../common/components/History/index.vue","webpack:///../common/components/History/index.vue?918f","webpack:///../common/components/History/index.vue?4671","webpack:///../common/components/History/Item.vue?aa71","webpack:///../common/components/History/index.vue?9527"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","ref","attrs","_l","event","_b","key","id","histories","on","$event","show_form","directives","name","rawName","value","expression","domProps","Array","isArray","_i","$$a","$$el","target","$$c","checked","$$v","$$i","concat","slice","style","margin","_e","staticRenderFns","preventDefault","submit","apply","arguments","$emit","composing","date","time","message","pending","component","class","edition","content_editable","admin","_s","_message","handlerInput","date_edited","time_edited","format","validate","remove","components","props","Number","history","type","default","data","computed","_history","sort","$refs","$el","mounted","console","log"],"mappings":"2LAAA,W,2CCAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,UAAU,CAACE,YAAY,mBAAmB,CAACF,EAAG,KAAK,CAACJ,EAAIO,GAAG,gBAAgBH,EAAG,mBAAmB,CAACI,IAAI,YAAYF,YAAY,wBAAwBG,MAAM,CAAC,IAAM,MAAM,KAAO,0BAA0BT,EAAIU,GAAIV,EAAY,UAAE,SAASW,GAAO,OAAOP,EAAG,cAAcJ,EAAIY,GAAG,CAACC,IAAIF,EAAMG,GAAGL,MAAM,CAAC,WAAaT,EAAIc,KAAK,cAAcH,GAAM,OAAU,GAAIX,EAAS,MAAEI,EAAG,MAAM,CAACE,YAAY,wBAAwB,CAAEN,EAAa,UAAEI,EAAG,cAAc,CAACK,MAAM,CAAC,GAAKT,EAAIc,GAAG,UAAYd,EAAIe,WAAWC,GAAG,CAAC,KAAO,SAASC,GAAQjB,EAAIkB,WAAY,MAAU,CAACd,EAAG,QAAQ,CAACe,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUC,MAAOtB,EAAa,UAAEuB,WAAW,cAAcd,MAAM,CAAC,KAAO,WAAW,GAAM,wBAA0BT,EAAIc,GAAI,OAAS,IAAIU,SAAS,CAAC,QAAUC,MAAMC,QAAQ1B,EAAIkB,WAAWlB,EAAI2B,GAAG3B,EAAIkB,UAAU,OAAO,EAAGlB,EAAa,WAAGgB,GAAG,CAAC,OAAS,SAASC,GAAQ,IAAIW,EAAI5B,EAAIkB,UAAUW,EAAKZ,EAAOa,OAAOC,IAAIF,EAAKG,QAAuB,GAAGP,MAAMC,QAAQE,GAAK,CAAC,IAAIK,EAAI,KAAKC,EAAIlC,EAAI2B,GAAGC,EAAIK,GAAQJ,EAAKG,QAASE,EAAI,IAAIlC,EAAIkB,UAAUU,EAAIO,OAAO,CAACF,KAAYC,GAAK,IAAIlC,EAAIkB,UAAUU,EAAIQ,MAAM,EAAEF,GAAKC,OAAOP,EAAIQ,MAAMF,EAAI,UAAWlC,EAAIkB,UAAUa,MAAS3B,EAAG,QAAQ,CAACE,YAAY,MAAM+B,MAAM,CAAGC,OAAQ,QAAU7B,MAAM,CAAC,IAAO,wBAA0BT,EAAIc,KAAM,CAACV,EAAG,OAAO,CAACK,MAAM,CAAC,KAAO,aAAaT,EAAIO,GAAG,2BAA2B,KAAK,GAAGP,EAAIuC,MAAM,IACp5CC,EAAkB,G,8CCDlB,EAAS,WAAa,IAAIxC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,OAAO,CAACE,YAAY,wBAAwBU,GAAG,CAAC,OAAS,SAASC,GAAgC,OAAxBA,EAAOwB,iBAAwBzC,EAAI0C,OAAOC,MAAM,KAAMC,YAAY,MAAQ,SAAS3B,GAAgC,OAAxBA,EAAOwB,iBAAwBzC,EAAI6C,MAAM,WAAW,CAACzC,EAAG,QAAQ,CAACJ,EAAIO,GAAG,WAAWH,EAAG,QAAQ,CAACe,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUC,MAAOtB,EAAQ,KAAEuB,WAAW,SAASd,MAAM,CAAC,KAAO,QAAQe,SAAS,CAAC,MAASxB,EAAQ,MAAGgB,GAAG,CAAC,MAAQ,SAASC,GAAWA,EAAOa,OAAOgB,YAAqB9C,EAAI+C,KAAK9B,EAAOa,OAAOR,aAAYlB,EAAG,QAAQ,CAACJ,EAAIO,GAAG,YAAYH,EAAG,QAAQ,CAACe,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUC,MAAOtB,EAAQ,KAAEuB,WAAW,SAASd,MAAM,CAAC,KAAO,QAAQe,SAAS,CAAC,MAASxB,EAAQ,MAAGgB,GAAG,CAAC,MAAQ,SAASC,GAAWA,EAAOa,OAAOgB,YAAqB9C,EAAIgD,KAAK/B,EAAOa,OAAOR,aAAYlB,EAAG,QAAQ,CAACK,MAAM,CAAC,IAAO,oCAAsCT,EAAIc,KAAM,CAACd,EAAIO,GAAG,cAAcH,EAAG,WAAW,CAACe,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUC,MAAOtB,EAAW,QAAEuB,WAAW,YAAYd,MAAM,CAAC,GAAM,oCAAsCT,EAAIc,GAAI,KAAO,KAAKU,SAAS,CAAC,MAASxB,EAAW,SAAGgB,GAAG,CAAC,MAAQ,SAASC,GAAWA,EAAOa,OAAOgB,YAAqB9C,EAAIiD,QAAQhC,EAAOa,OAAOR,WAAUlB,EAAG,MAAM,CAACE,YAAY,+BAA+B,CAACF,EAAG,SAAS,CAACK,MAAM,CAAC,KAAO,SAAS,SAAWT,EAAIkD,UAAU,CAAClD,EAAIO,GAAG,aAAaH,EAAG,SAAS,CAACK,MAAM,CAAC,KAAO,UAAU,CAACT,EAAIO,GAAG,kBAC96C,EAAkB,G,oCC+BtB,GACA,mBACA,OACA,UACA,gBAEA,KANA,WAOA,0CACA,iCACA,KACA,KAEA,2CAEA,yCACA,gBACA,mCAFA,IAIA,OAJA,WAIA,kKACA,UADA,oDAGA,cAEA,YALA,oDAMA,qBANA,wDAQA,aARA,UAUA,OACA,gBACA,MACA,kBACA,qCAdA,QAiBA,aACA,gBACA,uDAnBA,kDClDoZ,I,wBCQhZ4C,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,MAIa,EAAAA,E,QCnBX,EAAS,WAAa,IAAInD,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,wBAAwBG,MAAM,CAAC,SAAW,MAAM,CAACL,EAAG,IAAI,CAACI,IAAI,UAAUF,YAAY,iCAAiC8C,MAAM,CAAC,CAAEC,QAASrD,EAAIsD,kBAAoBtD,EAAIuD,QAAS9C,MAAM,CAAC,gBAAkBT,EAAIsD,kBAAkB9B,SAAS,CAAC,UAAYxB,EAAIwD,GAAGxD,EAAIyD,WAAWzC,GAAG,CAAC,MAAQhB,EAAI0D,gBAAgBtD,EAAG,OAAO,CAACE,YAAY,gCAAgC,CAACF,EAAG,OAAO,CAACE,YAAY,+BAA+B,CAAEN,EAAoB,iBAAE,CAACI,EAAG,QAAQ,CAACe,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUC,MAAOtB,EAAe,YAAEuB,WAAW,gBAAgBd,MAAM,CAAC,KAAO,QAAQe,SAAS,CAAC,MAASxB,EAAe,aAAGgB,GAAG,CAAC,MAAQ,SAASC,GAAWA,EAAOa,OAAOgB,YAAqB9C,EAAI2D,YAAY1C,EAAOa,OAAOR,WAAUtB,EAAIO,GAAG,OAAOH,EAAG,QAAQ,CAACe,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUC,MAAOtB,EAAe,YAAEuB,WAAW,gBAAgBd,MAAM,CAAC,KAAO,QAAQe,SAAS,CAAC,MAASxB,EAAe,aAAGgB,GAAG,CAAC,MAAQ,SAASC,GAAWA,EAAOa,OAAOgB,YAAqB9C,EAAI4D,YAAY3C,EAAOa,OAAOR,YAAW,CAACtB,EAAIO,GAAG,IAAIP,EAAIwD,GAAGxD,EAAI+C,KAAKc,OAAO,gBAAgB,OAAO,GAAI7D,EAAS,MAAEI,EAAG,OAAO,CAACE,YAAY,kCAAkC,CAAEN,EAAoB,iBAAE,CAACI,EAAG,OAAO,CAACE,YAAY,2CAA2CU,GAAG,CAAC,MAAQhB,EAAI8D,WAAW,CAAC9D,EAAIO,GAAG,OAAOH,EAAG,OAAO,CAACE,YAAY,yCAAyCU,GAAG,CAAC,MAAQ,SAASC,GAAQjB,EAAIsD,kBAAmB,KAAS,CAACtD,EAAIO,GAAG,QAAQ,CAACH,EAAG,OAAO,CAACE,YAAY,uCAAuCU,GAAG,CAAC,MAAQ,SAASC,GAAQjB,EAAIsD,kBAAmB,KAAQ,CAACtD,EAAIO,GAAG,gBAAgBH,EAAG,OAAO,CAACE,YAAY,yCAAyCU,GAAG,CAAC,MAAQhB,EAAI+D,SAAS,CAAC/D,EAAIO,GAAG,iBAAiB,GAAGP,EAAIuC,UAChvD,EAAkB,G,sDCuDtB,8BAEA,GACA,mBACA,OACA,UACA,kBACA,OACA,eACA,qBAEA,KATA,WAUA,SACA,qBACA,iCACA,4BAEA,yEAEA,0CACA,gBACA,6CAFA,IAIA,cAJA,WAKA,2CAEA,UACA,IADA,WAEA,2BAEA,IAJA,SAIA,GACA,qDAGA,aAfA,WAgBA,6BAGA,OACA,iBADA,SACA,GACA,iCAEA,0CACA,gDACA,8CAIA,wDACA,gBACA,mCAEA,gBACA,oCACA,qCANA,IAQA,aARA,SAQA,GAEA,wCAEA,SAZA,WAYA,mKACA,sBACA,cADA,YACA,eACA,oBAGA,YANA,yCAOA,OACA,4CACA,0BATA,cAaA,GACA,kCACA,0BAfA,SAkBA,mDAlBA,OAoBA,sBApBA,8CAsBA,OAlCA,WAmCA,cACA,oCACA,0DACA,0CACA,SACA,2BACA,wBCjJoZ,ICQhZ,G,UAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,OAIa,I,QC+Bf,GACEnB,KAAM,UACN4C,WAAY,CAAd,6BACEC,MAAO,CACLnD,GAAIoD,OACJC,QAAS,CACPC,KAAM3C,MACN4C,QAAS,WAAf,YAGEC,KAVF,WAWI,IAAJ,KAEI,MAAO,CAAX,cAEEC,SAAU,OAAZ,OAAY,CAAZ,kBACA,gBACI,MAAJ,YAAM,IAAN,UAAM,OAAN,MAFA,IAIIC,SAJJ,WAKM,OAAOvE,KAAKkE,QAAQM,MAAK,SAA/B,kCACA,qCAGI1D,UATJ,WAUM,OAAOd,KAAKyE,MAAM3D,UAAU4D,OAGhCC,QA5BF,WA6BIC,QAAQC,IAAI7E,KAAKc,aC/EgY,ICQjZ,G,UAAY,eACd,EACAhB,EACAyC,GACA,EACA,KACA,WACA,OAIa,e,2CCnBf,W,kCCAA","file":"js/chunk-1026f278.chunk-1026f278.2fba3962.js","sourcesContent":["export * from \"-!../../../mobile_dev/node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../mobile_dev/node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../mobile_dev/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../mobile_dev/node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../mobile_dev/node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../mobile_dev/node_modules/vue-loader/lib/index.js??vue-loader-options!./Form.vue?vue&type=style&index=0&id=d8135f24&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',{staticClass:\"project-history\"},[_c('h3',[_vm._v(\"Historique\")]),_c('transition-group',{ref:\"histories\",staticClass:\"project-history__list\",attrs:{\"tag\":\"div\",\"name\":\"project-history__list\"}},_vm._l((_vm._history),function(event){return _c('HistoryItem',_vm._b({key:event.id,attrs:{\"project_id\":_vm.id}},'HistoryItem',event,false))}),1),(_vm.admin)?_c('div',{staticClass:\"project-history__new\"},[(_vm.show_form)?_c('HistoryForm',{attrs:{\"id\":_vm.id,\"container\":_vm.histories},on:{\"hide\":function($event){_vm.show_form = false}}}):[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.show_form),expression:\"show_form\"}],attrs:{\"type\":\"checkbox\",\"id\":(\"history-form__input__\" + _vm.id),\"hidden\":\"\"},domProps:{\"checked\":Array.isArray(_vm.show_form)?_vm._i(_vm.show_form,null)>-1:(_vm.show_form)},on:{\"change\":function($event){var $$a=_vm.show_form,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.show_form=$$a.concat([$$v]))}else{$$i>-1&&(_vm.show_form=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.show_form=$$c}}}}),_c('label',{staticClass:\"btn\",style:({ margin: 'auto' }),attrs:{\"for\":(\"history-form__input__\" + _vm.id)}},[_c('Icon',{attrs:{\"icon\":\"comment\"}}),_vm._v(\" Ajouter un événement \")],1)]],2):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('form',{staticClass:\"project-history__form\",on:{\"submit\":function($event){$event.preventDefault();return _vm.submit.apply(null, arguments)},\"reset\":function($event){$event.preventDefault();return _vm.$emit('hide')}}},[_c('label',[_vm._v(\" Date: \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.date),expression:\"date\"}],attrs:{\"type\":\"date\"},domProps:{\"value\":(_vm.date)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.date=$event.target.value}}})]),_c('label',[_vm._v(\" Heure: \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.time),expression:\"time\"}],attrs:{\"type\":\"time\"},domProps:{\"value\":(_vm.time)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.time=$event.target.value}}})]),_c('label',{attrs:{\"for\":(\"project-history__form__textarea__\" + _vm.id)}},[_vm._v(\"Message:\")]),_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.message),expression:\"message\"}],attrs:{\"id\":(\"project-history__form__textarea__\" + _vm.id),\"rows\":\"5\"},domProps:{\"value\":(_vm.message)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.message=$event.target.value}}}),_c('div',{staticClass:\"project-history__form__btns\"},[_c('button',{attrs:{\"type\":\"submit\",\"disabled\":_vm.pending}},[_vm._v(\"Envoyer\")]),_c('button',{attrs:{\"type\":\"reset\"}},[_vm._v(\"Annuler\")])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n\t<form\r\n\t\tclass=\"project-history__form\"\r\n\t\t@submit.prevent=\"submit\"\r\n\t\t@reset.prevent=\"$emit('hide')\"\r\n\t>\r\n\t\t<label>\r\n\t\t\tDate:\r\n\t\t\t<input type=\"date\" v-model=\"date\" />\r\n\t\t</label>\r\n\t\t<label>\r\n\t\t\tHeure:\r\n\t\t\t<input type=\"time\" v-model=\"time\" />\r\n\t\t</label>\r\n\t\t<label :for=\"`project-history__form__textarea__${id}`\">Message:</label>\r\n\t\t<textarea\r\n\t\t\t:id=\"`project-history__form__textarea__${id}`\"\r\n\t\t\tv-model=\"message\"\r\n\t\t\trows=\"5\"\r\n\t\t></textarea>\r\n\r\n\t\t<div class=\"project-history__form__btns\">\r\n\t\t\t<button type=\"submit\" :disabled=\"pending\">Envoyer</button>\r\n\t\t\t<button type=\"reset\">Annuler</button>\r\n\t\t</div>\r\n\t</form>\r\n</template>\r\n\r\n<script>\r\n\timport { STORE } from '@Constants'\r\n\timport { mapActions } from '@Modules/vuex'\r\n\r\n\texport default {\r\n\t\tname: 'HistoryForm',\r\n\t\tprops: {\r\n\t\t\tid: Number,\r\n\t\t\tcontainer: null,\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\tconst date = this.$moment().format('YYYY-MM-DD')\r\n\t\t\tconst time = this.$moment().format('HH:mm')\r\n\t\t\tconst message = ''\r\n\t\t\tconst pending = false\r\n\r\n\t\t\treturn { date, time, message, pending }\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t...mapActions({\r\n\t\t\t\tadd: STORE.ACTIONS.HISTORY_POST,\r\n\t\t\t}),\r\n\t\t\tasync submit() {\r\n\t\t\t\tif (this.pending) return\r\n\r\n\t\t\t\tconst date = this.$moment()\r\n\r\n\t\t\t\tif (!date.isValid()) return\r\n\t\t\t\tif (this.message.length === 0) return\r\n\r\n\t\t\t\tthis.pending = true\r\n\r\n\t\t\t\tawait this.add({\r\n\t\t\t\t\tproject_id: this.id,\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tmessage: this.message,\r\n\t\t\t\t\t\tdate: date.format('DD/MM/YYYY HH:mm'),\r\n\t\t\t\t\t},\r\n\t\t\t\t})\r\n\t\t\t\tthis.pending = false\r\n\t\t\t\tthis.$emit('hide')\r\n\t\t\t\tthis.container.scrollTo({ top: 0, left: 0, behavior: 'smooth' })\r\n\t\t\t},\r\n\t\t},\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\t.project-history__form {\r\n\t\twidth: 100%;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 0.5em;\r\n\t\talign-items: stretch;\r\n\t\tborder: solid 1px hsla(0, 0%, 0%, 0.2);\r\n\t\tpadding: 1em;\r\n\t\tborder-radius: 0.75em;\r\n\t}\r\n\r\n\ttextarea {\r\n\t\tresize: none;\r\n\t}\r\n\r\n\tinput {\r\n\t\toutline: none;\r\n\t\tpadding: 0;\r\n\t\tpadding-left: 0.5rem;\r\n\t\tborder: 0;\r\n\t\tfont: inherit;\r\n\t\tbackground-color: transparent;\r\n\t}\r\n\r\n\t.project-history__form__btns {\r\n\t\tmargin-left: auto;\r\n\t\tdisplay: flex;\r\n\t\tgap: 0.5em;\r\n\t\talign-items: center;\r\n\t}\r\n</style>\r\n","import mod from \"-!../../../mobile_dev/node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../mobile_dev/node_modules/thread-loader/dist/cjs.js!../../../mobile_dev/node_modules/babel-loader/lib/index.js!../../../mobile_dev/node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../mobile_dev/node_modules/vue-loader/lib/index.js??vue-loader-options!./Form.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../mobile_dev/node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../mobile_dev/node_modules/thread-loader/dist/cjs.js!../../../mobile_dev/node_modules/babel-loader/lib/index.js!../../../mobile_dev/node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../mobile_dev/node_modules/vue-loader/lib/index.js??vue-loader-options!./Form.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Form.vue?vue&type=template&id=d8135f24&scoped=true&\"\nimport script from \"./Form.vue?vue&type=script&lang=js&\"\nexport * from \"./Form.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Form.vue?vue&type=style&index=0&id=d8135f24&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../mobile_dev/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d8135f24\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"project-history__item\",attrs:{\"tabindex\":\"0\"}},[_c('p',{ref:\"message\",staticClass:\"project-history__item__message\",class:[{ edition: _vm.content_editable && _vm.admin }],attrs:{\"contenteditable\":_vm.content_editable},domProps:{\"innerHTML\":_vm._s(_vm._message)},on:{\"input\":_vm.handlerInput}}),_c('span',{staticClass:\"project-history__item__infos\"},[_c('span',{staticClass:\"project-history__item__date\"},[(_vm.content_editable)?[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.date_edited),expression:\"date_edited\"}],attrs:{\"type\":\"date\"},domProps:{\"value\":(_vm.date_edited)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.date_edited=$event.target.value}}}),_vm._v(\" ~ \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.time_edited),expression:\"time_edited\"}],attrs:{\"type\":\"time\"},domProps:{\"value\":(_vm.time_edited)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.time_edited=$event.target.value}}})]:[_vm._v(\" \"+_vm._s(_vm.date.format(\"L [~] HH:mm\"))+\" \")]],2),(_vm.admin)?_c('span',{staticClass:\"project-history__item__actions\"},[(_vm.content_editable)?[_c('span',{staticClass:\"project-history__item__actions__validate\",on:{\"click\":_vm.validate}},[_vm._v(\"✓\")]),_c('span',{staticClass:\"project-history__item__actions__cancel\",on:{\"click\":function($event){_vm.content_editable = false}}},[_vm._v(\"✗\")])]:[_c('span',{staticClass:\"project-history__item__actions__edit\",on:{\"click\":function($event){_vm.content_editable = true}}},[_vm._v(\" Modifier \")]),_c('span',{staticClass:\"project-history__item__actions__remove\",on:{\"click\":_vm.remove}},[_vm._v(\"Supprimer\")])]],2):_vm._e()])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n\t<div class=\"project-history__item\" tabindex=\"0\">\r\n\t\t<p\r\n\t\t\t:contenteditable=\"content_editable\"\r\n\t\t\tref=\"message\"\r\n\t\t\tclass=\"project-history__item__message\"\r\n\t\t\t:class=\"[{ edition: content_editable && admin }]\"\r\n\t\t\tv-html=\"_message\"\r\n\t\t\t@input=\"handlerInput\"\r\n\t\t></p>\r\n\r\n\t\t<span class=\"project-history__item__infos\">\r\n\t\t\t<span class=\"project-history__item__date\">\r\n\t\t\t\t<template v-if=\"content_editable\">\r\n\t\t\t\t\t<input type=\"date\" v-model=\"date_edited\" /> ~\r\n\t\t\t\t\t<input type=\"time\" v-model=\"time_edited\" />\r\n\t\t\t\t</template>\r\n\t\t\t\t<template v-else>\r\n\t\t\t\t\t{{ date.format(\"L [~] HH:mm\") }}\r\n\t\t\t\t</template>\r\n\t\t\t</span>\r\n\r\n\t\t\t<span v-if=\"admin\" class=\"project-history__item__actions\">\r\n\t\t\t\t<template v-if=\"content_editable\">\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\tclass=\"project-history__item__actions__validate\"\r\n\t\t\t\t\t\t@click=\"validate\"\r\n\t\t\t\t\t\t>✓</span\r\n\t\t\t\t\t>\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\tclass=\"project-history__item__actions__cancel\"\r\n\t\t\t\t\t\t@click=\"content_editable = false\"\r\n\t\t\t\t\t\t>✗</span\r\n\t\t\t\t\t>\r\n\t\t\t\t</template>\r\n\t\t\t\t<template v-else>\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\tclass=\"project-history__item__actions__edit\"\r\n\t\t\t\t\t\t@click=\"content_editable = true\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tModifier\r\n\t\t\t\t\t</span>\r\n\t\t\t\t\t<span class=\"project-history__item__actions__remove\" @click=\"remove\"\r\n\t\t\t\t\t\t>Supprimer</span\r\n\t\t\t\t\t>\r\n\t\t\t\t</template>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport { mapActions, mapMutations, mapState } from \"@Modules/vuex\"\r\nimport { POPUP_VARIANTS, STORE, OVERLAY } from \"@Constants\"\r\n\r\nimport { useMoment } from \"@Hooks\"\r\nconst { Moment } = useMoment()\r\n\r\nexport default {\r\n\tname: \"HistoryItem\",\r\n\tprops: {\r\n\t\tid: Number,\r\n\t\tproject_id: Number,\r\n\t\tdate: Moment,\r\n\t\tmessage: String,\r\n\t\tstopEdition: Boolean,\r\n\t},\r\n\tdata() {\r\n\t\tconst content_editable = false\r\n\t\tconst message_edited = this._message_w_br\r\n\t\tconst date_edited = this.date.format(\"YYYY-MM-DD\")\r\n\t\tconst time_edited = this.date.format(\"HH:mm\")\r\n\r\n\t\treturn { content_editable, message_edited, date_edited, time_edited }\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapState({\r\n\t\t\tadmin: ({ admin }) => admin,\r\n\t\t}),\r\n\t\t_message_w_br() {\r\n\t\t\treturn this.message.replace(/\\n/g, \"<br>\")\r\n\t\t},\r\n\t\t_message: {\r\n\t\t\tget() {\r\n\t\t\t\treturn this._message_w_br\r\n\t\t\t},\r\n\t\t\tset(message) {\r\n\t\t\t\tthis.message_edited = message.replace(/<br>/g, \"\\n\").trim()\r\n\t\t\t},\r\n\t\t},\r\n\t\tmessage_html() {\r\n\t\t\treturn this.$refs.message\r\n\t\t},\r\n\t},\r\n\twatch: {\r\n\t\tcontent_editable(value) {\r\n\t\t\tif (value) this.$emit(\"content-edition\")\r\n\t\t\telse {\r\n\t\t\t\tthis.message_html.innerHTML = this._message\r\n\t\t\t\tthis.date_edited = this.date.format(\"YYYY-MM-DD\")\r\n\t\t\t\tthis.time_edited = this.date.format(\"HH:mm\")\r\n\t\t\t}\r\n\t\t},\r\n\t},\r\n\tmethods: {\r\n\t\t...mapMutations({\r\n\t\t\tpop: STORE.MUTATIONS.POPUPS_ADD,\r\n\t\t}),\r\n\t\t...mapActions({\r\n\t\t\tconfirm: STORE.ACTIONS.CONFIRM_SHOW,\r\n\t\t\tupdate: STORE.ACTIONS.HISTORY_PUT,\r\n\t\t}),\r\n\t\thandlerInput(e) {\r\n\t\t\t// console.log(e)\r\n\t\t\tthis.message_edited = e.target.innerHTML\r\n\t\t},\r\n\t\tasync validate() {\r\n\t\t\tconst date = this.$moment(\r\n\t\t\t\t`${this.date_edited} ${this.time_edited}`,\r\n\t\t\t\t\"YYYY-MM-DD HH:mm\"\r\n\t\t\t)\r\n\r\n\t\t\tif (!date.isValid()) {\r\n\t\t\t\treturn this.pop({\r\n\t\t\t\t\tmessage: \"Date ou heure renseignée invalide\",\r\n\t\t\t\t\tvariant: POPUP_VARIANTS.WARNING,\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tconst data = {\r\n\t\t\t\tdate: date.format(\"DD/MM/YYYY HH:mm\"),\r\n\t\t\t\tmessage: this.message_edited,\r\n\t\t\t}\r\n\r\n\t\t\tawait this.update({ project_id: this.project_id, id: this.id, data })\r\n\r\n\t\t\tthis.content_editable = false\r\n\t\t},\r\n\t\tremove() {\r\n\t\t\tthis.confirm({\r\n\t\t\t\theader: \"Suppression d'un événement\",\r\n\t\t\t\ttext: \"Êtes-vous sûr de vouloir supprimer cet événement ?\",\r\n\t\t\t\taction: OVERLAY.ACTIONS.REMOVE_HISTORY_ITEM,\r\n\t\t\t\tdetails: {\r\n\t\t\t\t\tproject_id: this.project_id,\r\n\t\t\t\t\tevent_id: this.id,\r\n\t\t\t\t},\r\n\t\t\t})\r\n\t\t},\r\n\t},\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.project-history__item {\r\n\tdisplay: flex;\r\n\tflex-direction: column-reverse;\r\n\talign-items: flex-start;\r\n\tposition: relative;\r\n\tgap: 0.5em;\r\n}\r\n\r\n.project-history__item__message {\r\n\tposition: relative;\r\n\tz-index: 2;\r\n\tfont-weight: normal;\r\n\tbackground-color: rgba(0, 0, 0, 0.05);\r\n\tpadding: 1em;\r\n\tborder-radius: 0.75em;\r\n\r\n\tborder: solid 1px transparent;\r\n\tflex: 1 1 auto;\r\n}\r\n.project-history__item__message.edition {\r\n\tborder-color: currentColor;\r\n\tbackground-color: transparent;\r\n}\r\n\r\n.project-history__item:hover .project-history__item__actions,\r\n.project-history__item:focus .project-history__item__actions,\r\n.project-history__item__message.edition\r\n\t~ .project-history__item__infos\r\n\t.project-history__item__actions {\r\n\topacity: 1;\r\n\tbottom: 0;\r\n}\r\n\r\n.project-history__item__infos {\r\n\tposition: relative;\r\n\tz-index: 1;\r\n\tbottom: 0;\r\n\topacity: 1;\r\n\tfont-size: 0.75em;\r\n\tfont-weight: normal;\r\n\ttransition-property: opacity top;\r\n\ttransition-duration: 500ms;\r\n}\r\n.project-history__item__date {\r\n\tfont-style: italic;\r\n\tposition: relative;\r\n}\r\n\r\n.project-history__item__actions {\r\n\tposition: relative;\r\n\tz-index: 1;\r\n\tbottom: -1em;\r\n\topacity: 0;\r\n\ttransition-property: opacity bottom;\r\n\ttransition-duration: 500ms;\r\n}\r\n\r\n.project-history__item__actions__edit {\r\n\tcursor: pointer;\r\n\tcolor: var(--color-secondary);\r\n\tpadding: 0 0.5em;\r\n}\r\n.project-history__item__actions__remove {\r\n\tcursor: pointer;\r\n\tcolor: crimson;\r\n\tpadding: 0 0.5em;\r\n}\r\n\r\n.project-history__item__actions__validate {\r\n\tcursor: pointer;\r\n\tcolor: darkgreen;\r\n\r\n\tfont-size: 1.5em;\r\n\tpadding: 0 0.5em;\r\n}\r\n.project-history__item__actions__cancel {\r\n\tcursor: pointer;\r\n\tcolor: crimson;\r\n\tfont-size: 1.5em;\r\n\tpadding: 0 0.5em;\r\n}\r\n\r\n.project-history__list-enter-active:nth-child(odd),\r\n.project-history__list-enter-to:nth-child(odd),\r\n.project-history__list-leave-active:nth-child(odd) {\r\n\tleft: 0%;\r\n\topacity: 1;\r\n\ttransition: all 1.5s;\r\n}\r\n.project-history__list-enter-active:nth-child(even),\r\n.project-history__list-enter-to:nth-child(even),\r\n.project-history__list-leave-active:nth-child(even) {\r\n\tright: 0;\r\n\topacity: 1;\r\n\ttransition: all 1.5s;\r\n}\r\n\r\n.project-history__list-leave-to:nth-child(odd),\r\n.project-history__list-enter:nth-child(odd) {\r\n\tleft: -100%;\r\n\topacity: 0;\r\n}\r\n.project-history__list-leave-to:nth-child(even),\r\n.project-history__list-enter:nth-child(even) {\r\n\tright: -100%;\r\n\topacity: 0;\r\n}\r\n</style>\r\n","import mod from \"-!../../../mobile_dev/node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../mobile_dev/node_modules/thread-loader/dist/cjs.js!../../../mobile_dev/node_modules/babel-loader/lib/index.js!../../../mobile_dev/node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../mobile_dev/node_modules/vue-loader/lib/index.js??vue-loader-options!./Item.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../mobile_dev/node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../mobile_dev/node_modules/thread-loader/dist/cjs.js!../../../mobile_dev/node_modules/babel-loader/lib/index.js!../../../mobile_dev/node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../mobile_dev/node_modules/vue-loader/lib/index.js??vue-loader-options!./Item.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Item.vue?vue&type=template&id=fe399cbc&scoped=true&\"\nimport script from \"./Item.vue?vue&type=script&lang=js&\"\nexport * from \"./Item.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Item.vue?vue&type=style&index=0&id=fe399cbc&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../mobile_dev/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"fe399cbc\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <section class=\"project-history\">\r\n    <h3>Historique</h3>\r\n    <transition-group\r\n      tag=\"div\"\r\n      name=\"project-history__list\"\r\n      class=\"project-history__list\"\r\n      ref=\"histories\"\r\n    >\r\n      <HistoryItem\r\n        v-for=\"event in _history\"\r\n        :key=\"event.id\"\r\n        v-bind=\"event\"\r\n        :project_id=\"id\"\r\n      />\r\n    </transition-group>\r\n\r\n    <div class=\"project-history__new\" v-if=\"admin\">\r\n      <HistoryForm\r\n        v-if=\"show_form\"\r\n        :id=\"id\"\r\n        :container=\"histories\"\r\n        @hide=\"show_form = false\"\r\n      />\r\n\r\n      <template v-else>\r\n        <input\r\n          type=\"checkbox\"\r\n          :id=\"`history-form__input__${id}`\"\r\n          hidden\r\n          v-model=\"show_form\"\r\n        />\r\n        <label\r\n          class=\"btn\"\r\n          :for=\"`history-form__input__${id}`\"\r\n          :style=\"{ margin: 'auto' }\"\r\n        >\r\n          <Icon icon=\"comment\" />\r\n          Ajouter un événement\r\n        </label>\r\n      </template>\r\n    </div>\r\n  </section>\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from '@Modules/vuex'\r\nimport HistoryForm from './Form.vue'\r\nimport HistoryItem from './Item.vue'\r\n\r\nexport default {\r\n  name: 'History',\r\n  components: { HistoryItem, HistoryForm },\r\n  props: {\r\n    id: Number,\r\n    history: {\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n  },\r\n  data() {\r\n    const show_form = false\r\n\r\n    return { show_form }\r\n  },\r\n  computed: {\r\n    ...mapState({\r\n      admin: ({ admin }) => admin,\r\n    }),\r\n    _history() {\r\n      return this.history.sort(({ date: a }, { date: b }) =>\r\n        a.isBefore(b) ? 1 : a.isSame(b) ? 0 : -1,\r\n      )\r\n    },\r\n    histories() {\r\n      return this.$refs.histories.$el\r\n    },\r\n  },\r\n  mounted() {\r\n    console.log(this.histories)\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.project-history {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: stretch;\r\n  gap: 1em;\r\n}\r\n.project-history__list {\r\n  display: flex;\r\n  flex-direction: column;\r\n  overflow-y: auto;\r\n  overflow-x: hidden;\r\n  max-height: 30vh;\r\n  gap: 2em;\r\n}\r\n.project-history__new {\r\n  margin: auto;\r\n  width: 100%;\r\n  display: grid;\r\n  place-items: center;\r\n}\r\n</style>\r\n","import mod from \"-!../../../mobile_dev/node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../mobile_dev/node_modules/thread-loader/dist/cjs.js!../../../mobile_dev/node_modules/babel-loader/lib/index.js!../../../mobile_dev/node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../mobile_dev/node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../mobile_dev/node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../mobile_dev/node_modules/thread-loader/dist/cjs.js!../../../mobile_dev/node_modules/babel-loader/lib/index.js!../../../mobile_dev/node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../mobile_dev/node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=61803647&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=61803647&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../mobile_dev/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"61803647\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../mobile_dev/node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../mobile_dev/node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../mobile_dev/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../mobile_dev/node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../mobile_dev/node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../mobile_dev/node_modules/vue-loader/lib/index.js??vue-loader-options!./Item.vue?vue&type=style&index=0&id=fe399cbc&scoped=true&lang=css&\"","export * from \"-!../../../mobile_dev/node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../mobile_dev/node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../mobile_dev/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../mobile_dev/node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../mobile_dev/node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../mobile_dev/node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=61803647&scoped=true&lang=css&\""],"sourceRoot":""}